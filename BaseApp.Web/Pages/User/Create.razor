@page "/users/create"
@attribute [StreamRendering(true)]

<PageTitle>Create New User</PageTitle>

<h3>Enter User Details</h3>

@if (IsLoading)
{
    <p><em>Loading...</em></p>
}
else if (HasError)
{
    <div class="alert alert-danger">
        <h4 class="alert-heading">Error</h4>
        <p>Failed to load user profile. Please try again later..</p>
        @if (!string.IsNullOrEmpty(ErrorMessage))
        {
            <hr>
            <p class="mb-0">@ErrorMessage</p>
        }
    </div>
}
else
{
    <div class="row">
        <div class="col-md-4">
            <EditForm Model="@UserRequestDto" FormName="AddUser" OnValidSubmit="CreateUserAsync">
                <input type="hidden" />
                <DataAnnotationsValidator />
                <ValidationSummary />
                <div class="mb-3">
                    <label for="username" class="form-label">User Name: </label>
                    <InputText id="username" @bind-Value="UserRequestDto.UserName" class="form-control" />
                    <ValidationMessage For="@(() => UserRequestDto.UserName)" />
                </div>
                <div class="mb-3">
                    <label for="firstname" class="form-label">First Name: </label>
                    <InputText id="firstname" @bind-Value="UserRequestDto.FirstName" class="form-control" />
                    <ValidationMessage For="@(() => UserRequestDto.FirstName)" />
                </div>
                <div class="mb-3">
                    <label for="lastname" class="form-label">Last Name: </label>
                    <InputText id="lastname" @bind-Value="UserRequestDto.LastName" class="form-control" />                   
                    <ValidationMessage For="@(() => UserRequestDto.LastName)" />
                </div>
                <div class="mb-3">
                    <label for="email" class="form-label">Email: </label>
                    <InputText id="email" @bind-Value="UserRequestDto.Email" class="form-control" />
                    <ValidationMessage For="@(() => UserRequestDto.Email)" />
                </div>
                <div class="mb-3">
                    <label for="phonenumber" class="form-label">Phone Number: </label>
                    <InputText id="phonenumber" @bind-Value="UserRequestDto.PhoneNumber" class="form-control" />
                    <ValidationMessage For="@(() => UserRequestDto.PhoneNumber)" />
                </div>
                <div class="mb-3">
                    <label for="dateofbirth" class="form-label">Date of Birth: </label>
                    <InputDate id="dateofbirth" @bind-Value="UserRequestDto.DateOfBirth" class="form-control" />
                    <ValidationMessage For="@(() => UserRequestDto.DateOfBirth)" />
                </div>
                <button type="submit" class="btn btn-primary d-block w-100 mb-2" disabled="@IsSaving">@(IsSaving ? "Saving.." : "Save")</button>
            </EditForm>
            <a class="btn btn-danger d-block w-100 mt-2 mb-2" role="button" href="/users">Cancel</a>
        </div>
    </div>
}