@page "/users"
@using BaseApp.Data.User.Dtos
@using BaseApp.Web.Shared
@attribute [StreamRendering(true)]

<h3>User List</h3>

<RadzenDataGrid AllowFiltering="true" AllowColumnResize="true" AllowAlternatingRows="false"
                FilterMode="FilterMode.Advanced" AllowSorting="true" PageSize="@PageSize" AllowPaging="true"
                PagerHorizontalAlign="HorizontalAlign.Left" ShowPagingSummary="true"
                Data="@users" LogicalFilterOperator="LogicalFilterOperator.Or"
                TItem="UserDto" Count="@TotalRecords" LoadData="GetUserList" SelectionMode="DataGridSelectionMode.Single"
                @bind-Value="@selectedUsers">
    <Columns>
        <RadzenDataGridColumn Property="@nameof(UserDto.Id)" Filterable="false" Title="ID" Frozen="true" Width="80px" TextAlign="TextAlign.Center" />
        <RadzenDataGridColumn Property="@nameof(UserDto.UserName)" Title="User Name" Frozen="true" Width="160px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.FirstName)" Title="First Name" Width="160px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.LastName)" Title="Last Name" Width="160px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.Email)" Title="Email" Width="200px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.PhoneNumber)" Title="Phone" Width="160px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.Age)" Title="Age" Width="160px" />
        <RadzenDataGridColumn Property="@nameof(UserDto.IsActive)" Title="Is Active" Width="160px" />

        <RadzenDataGridColumn Title="Actions" Width="200px" Filterable="false" Sortable="false">
            <Template Context="user">
                <RadzenButton Text="Edit" ButtonStyle="ButtonStyle.Primary" Click="@(() => NavigateToEdit(user.Id))" />
                <RadzenButton Text="Delete" ButtonStyle="ButtonStyle.Danger" Click="@(() => ShowDeletePopup(user.Id, user.UserName))" />
            </Template>
        </RadzenDataGridColumn>
    </Columns>
</RadzenDataGrid>

<div class="figure-caption">
    <a class="btn btn-primary" role="button" href="/users/create">Create User</a>
</div>

<DeleteConfirmation @ref="DeleteConfirmationPopup"
                    Title="Confirm User Deletion"
                    OnConfirm="DeleteUser"
                    OnCancel="HandleCancel" />
