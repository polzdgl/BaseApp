@page "/company/companies"
@using BaseApp.Client.Shared
@using BaseApp.Data.SecurityExchange.Dtos

<PageTitle>Companies</PageTitle>

<RadzenRow>
    <RadzenColumn Size="12">
        <RadzenText Text="Companies" TextStyle="TextStyle.H3" TagName="TagName.H1" />
    </RadzenColumn>
</RadzenRow>

<br />
@if (!IsMarketDataLoaded && !IsLoading)
{
    <RadzenButton Text="Import Market Data" ButtonStyle="ButtonStyle.Primary" Click="@(() => ImportMarketData())" />
}
<br />
<br />

@if (IsLoading)
{
    <RadzenProgressBar Mode="ProgressBarMode.Indeterminate" Style="width: 100%;" />
}
else
{
    <RadzenDataGrid AllowFiltering="true" AllowColumnResize="true" AllowAlternatingRows="false"
                    FilterMode="FilterMode.Simple" AllowSorting="true"
                    Data="@fundableCompanies" FilterCaseSensitivity=FilterCaseSensitivity.CaseInsensitive LogicalFilterOperator=LogicalFilterOperator.And
                    TItem="FundableCompanyDto" LoadData="GetFundableCompaniesAsync" SelectionMode="DataGridSelectionMode.Single">
        <Columns>
            <RadzenDataGridColumn TItem="FundableCompanyDto" Property="@nameof(FundableCompanyDto.Id)" Filterable="false" Title="CIK" Frozen="true" Width="80px" TextAlign="TextAlign.Center" />
            <RadzenDataGridColumn TItem="FundableCompanyDto" Property="@nameof(FundableCompanyDto.Name)" Title="Name" Filterable="true" FilterOperator="FilterOperator.Contains" Frozen="true" Width="160px" />
            <RadzenDataGridColumn TItem="FundableCompanyDto" Property="@nameof(FundableCompanyDto.StandardFundableAmount)" Filterable="false" Title="Standard Fundable Amount" Width="160px" />
            <RadzenDataGridColumn TItem="FundableCompanyDto" Property="@nameof(FundableCompanyDto.SpecialFundableAmount)" Filterable="false" Title="Special Fundable Amount" Width="160px" />
        </Columns>
    </RadzenDataGrid>
}
